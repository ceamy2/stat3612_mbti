---
title: "Stat3616 FP"
author: "Eun Chong Chu"
date: "12/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Exploring Cancer Dataset

```{r}
#Reading cancer.csv

cancer <- read.csv("/Users/amy/Desktop/cancer_data.csv", header = TRUE)
attach(cancer)
library(ggplot2)
colnames(cancer)
```

#Counting dataset by counting cancer_id per diagnosis type
```{r}
fit <- lm(cancer$id~cancer$diagnosis)
summary(fit)
ggplot(as.data.frame(cancer),aes(factor(diagnosis))) + geom_bar()
```
#Below is the exploration of dataset variables one by one
```{r}
radius_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=radius_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(radius_mean)
#ggplot(as.data.frame(cancer), aes(x=factor(diagnosis), y=area_mean, shape=area_worst, color=area_se)) + geom_point()
fit_radius <- lm(cancer$id ~ cancer$diagnosis + cancer$radius_mean)
summary(fit_radius)
plot(fit_radius)
```

```{r}
texture_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=texture_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(texture_mean)
fit_texture <- lm(cancer$id ~ cancer$diagnosis + cancer$texture_mean)
summary(fit_texture)
plot(fit_texture)
```

```{r}
perimeter_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=perimeter_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(perimeter_mean)
fit_perimeter <- lm(cancer$id ~ cancer$diagnosis + cancer$perimeter_mean)
summary(fit_perimeter)
plot(fit_perimeter)
```

```{r}
area_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=area_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(area_mean)
fit_area <- lm(cancer$id ~ cancer$diagnosis + cancer$area_mean)
summary(fit_area)
plot(fit_area)
```

```{r}
smoothness_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=smoothness_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(smoothness_mean)
fit_smoothness <- lm(cancer$id ~ cancer$diagnosis + cancer$smoothness_mean)
summary(fit_smoothness)
plot(fit_smoothness)
```


```{r}
compactness_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=compactness_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(compactness_mean)
fit_compactness <- lm(cancer$id ~ cancer$diagnosis + cancer$compactness_mean)
summary(fit_compactness)
plot(fit_compactness)
```


```{r}
concavity_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=concavity_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(concavity_mean)
fit_concavity <- lm(cancer$id ~ cancer$diagnosis + cancer$concavity_mean)
summary(fit_concavity)
plot(fit_concavity)
```

```{r}
concave.points_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=concave.points_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(concave.points_mean)
fit_concave.points <- lm(cancer$id ~ cancer$diagnosis + cancer$concave.points_mean)
summary(fit_concave.points)
plot(fit_concave.points)
```

```{r}
symmetry_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=symmetry_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(symmetry_mean)
fit_symmetry <- lm(cancer$id ~ cancer$diagnosis + cancer$symmetry_mean)
summary(fit_symmetry)
plot(fit_symmetry)
```


```{r}
fractal_dimension_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=fractal_dimension_mean)) + geom_boxplot() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(fractal_dimension_mean)
fit_fractal <- lm(cancer$id ~ cancer$diagnosis + cancer$fractal_dimension_mean)
summary(fit_fractal)
plot(fit_fractal)
```





```{r}
fractal_dimension_mean <- ggplot(as.data.frame(cancer),aes(x=factor(diagnosis),y=fractal_dimension_mean)) + geom_point() + geom_smooth(method="lm",se=TRUE, fullrange=FALSE, level=0.95)
plot(fractal_dimension_mean)
fit_fractal <- lm(cancer$id ~ cancer$diagnosis + cancer$fractal_dimension_mean)
summary(fit_fractal)
plot(fit_fractal)
```


######## Wendy ########## 

```{r}
mydata<-cancer[, c(3,4,5,6,7,8,9,10,11,12)]
head(mydata)
res<-cor(mydata)
round(res,2)

#heatmap
col<- colorRampPalette(c("blue", "white", "red"))(20)
heatmap(x = res, col = col, symm = TRUE)

#Create the correlation heatmap with ggplot2
#install.packages("reshape2")
library(reshape2)
melted_res<-melt(res)
head(melted_res)
ggplot(data = melted_res, aes(x=Var1, y=Var2, fill=value)) + geom_tile()
get_upper_tri <- function(res){
  res[lower.tri(res)]<- NA
  return(res)}
upper_tri <- get_upper_tri(res)
upper_tri
library(reshape2)
melted_res <- melt(upper_tri, na.rm = TRUE)
# Heatmap
library(ggplot2)
ggplot(data = melted_res, aes(Var2, Var1, fill = value))+ 
  geom_tile(color = "white")+
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
                       midpoint = 0, limit = c(-1,1), space = "Lab", 
                       name="Pearson\nCorrelation") +
  theme_minimal()+ 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))+
  coord_fixed()

melted_res + 
  geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    panel.grid.major = element_blank(),
    panel.border = element_blank(),
    panel.background = element_blank(),
    axis.ticks = element_blank(),
    legend.justification = c(1, 0),
    legend.position = c(0.6, 0.7),
    legend.direction = "horizontal")+
  guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
  title.position = "top", title.hjust = 0.5))


#scatter plots
install.packages("PerformanceAnalytics")
library("PerformanceAnalytics")
chart.Correlation(my_data, histogram=TRUE, pch=19)
```




```{r}

mydata<-cancer[, c(3,4,5,6,7,8,9,10,11,12)]
head(mydata)
res<-cor(mydata)
round(res,2)
```